resources:
  jobs:
    WF_Dev_H360_TDW_Source_Staging_Batch_2_3_V1:
      name: WF_Dev-H360/TDW_Source_Staging_Batch-2/3_V1
      schedule:
        quartz_cron_expression: 0 00 3 ? * MON-FRI
        timezone_id: America/New_York
        pause_status: UNPAUSED
      tasks:
        - task_key: NB_Bronze_IFS_BatchControl_DataLoad
          notebook_task:
            notebook_path: ./../DataPlatform/Extraction/NB_SQL_TDW_H360_Extraction_Framework_IFS_BatchControl.py
            base_parameters:
              batch: "2"
              TableList: "218"
            source: WORKSPACE
          job_cluster_key: NB_Bronze_IFS_BatchControl_DataLoad_cluster
          max_retries: 2
          min_retry_interval_millis: 180000
        - task_key: NB_H360_TDW_Bronze_DataLoad_Marketing_Tables
          depends_on:
            - task_key: NB_Bronze_IFS_BatchControl_DataLoad
          notebook_task:
            notebook_path: ../DataPlatform/Extraction/NB_SQL_Marketing_Extraction_Framework.py
            base_parameters:
              batch: "2"
              TableList: 405,406,408,409,410,407,400,401,402,403,404,411
            source: WORKSPACE
          job_cluster_key: Bronze_DataLoad_Marketing_Tables_cluster
          max_retries: 3
          min_retry_interval_millis: 120000
          
        - task_key: NB_TDW_H360_Batch-2-Partition-1
          depends_on:
            - task_key: NB_Bronze_IFS_BatchControl_DataLoad
          notebook_task:
            notebook_path: ../DataPlatform/Extraction/NB_SQL_TDW_H360_Extraction.py
            base_parameters:
              batch: "2"
              TableList: 2,4,5,6,16,17,18,19,21,22,23,25,26,27,28,29,30,39,41,44,46,47,49,75,77,79,80,81,82,83,84,87,88,90,91,93,94,217,219,220,221,222,60,61,67,68,66,65,64,241
            source: WORKSPACE
          job_cluster_key: TDW_H360_Batch_2_3
          max_retries: 1
          min_retry_interval_millis: 180000
          
        - task_key: NB_TDW_H360_Batch-2-Partition-2
          depends_on:
            - task_key: NB_Bronze_IFS_BatchControl_DataLoad
          notebook_task:
            notebook_path: ../DataPlatform/Extraction/NB_SQL_TDW_H360_Extraction.py
            base_parameters:
              batch: "2"
              TableList: 95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,111,113,114,115,118,120,122,123,125,127,130,132,133,134,135,136,137,148,149,150,154,155,161,162,159,250,251,223,224,225,226,227,228,229,230,160,71,238,237,412,413,32,58,151,70,73,74,72,231,556
            source: WORKSPACE
          job_cluster_key: TDW_H360_Batch_2_3
          max_retries: 1
          min_retry_interval_millis: 180000
          
        - task_key: NB_TDW_H360_Batch-2-Partition-3
          depends_on:
            - task_key: NB_Bronze_IFS_BatchControl_DataLoad
          notebook_task:
            notebook_path: ../DataPlatform/Extraction/NB_SQL_TDW_H360_Extraction.py
            base_parameters:
              batch: "2"
              TableList: 215,214,213,211,216,233,234,235,205,204,203,210,209,208,207,236,252,254,255
            source: WORKSPACE
          job_cluster_key: TDW_H360_Batch_2_3
          max_retries: 1
          min_retry_interval_millis: 180000
          
        - task_key: Nb_TDW_H360_Batch_3_Partition-1
          depends_on:
            - task_key: NB_Bronze_IFS_BatchControl_DataLoad
          notebook_task:
            notebook_path: ../DataPlatform/Extraction/NB_SQL_TDW_H360_Extraction.py
            base_parameters:
              batch: "3"
              TableList: 8,9,11,20,24,35,36,48,76,89
            source: WORKSPACE
          job_cluster_key: TDW_H360_Batch_2_3
          max_retries: 1
          min_retry_interval_millis: 180000
          
        - task_key: Nb_TDW_H360_Batch_3_Partition_2
          depends_on:
            - task_key: NB_Bronze_IFS_BatchControl_DataLoad
          notebook_task:
            notebook_path: ../DataPlatform/Extraction/NB_SQL_TDW_H360_Extraction.py
            base_parameters:
              batch: "3"
              TableList: 92,62,63,69,110,112,116,124,126,128,129,138,142,146,12,59,240,555,40,558
            source: WORKSPACE
          job_cluster_key: TDW_H360_Batch_2_3
          max_retries: 3
          min_retry_interval_millis: 120000
          
      job_clusters:
        - job_cluster_key: Bronze_DataLoad_Marketing_Tables_cluster
          new_cluster:
            cluster_name: ""
            spark_version: 15.4.x-scala2.12
            azure_attributes:
              first_on_demand: 1
              availability: ON_DEMAND_AZURE
              spot_bid_max_price: -1
            node_type_id: Standard_D16ads_v5
            spark_env_vars:
              PYSPARK_PYTHON: /databricks/python3/bin/python3
            enable_elastic_disk: true
            data_security_mode: USER_ISOLATION
            runtime_engine: STANDARD
            autoscale:
              min_workers: 2
              max_workers: 4
        - job_cluster_key: Email_Notification_cluster
          new_cluster:
            cluster_name: ""
            spark_version: 15.4.x-scala2.12
            azure_attributes:
              first_on_demand: 1
              availability: ON_DEMAND_AZURE
              spot_bid_max_price: -1
            node_type_id: Standard_D4ds_v5
            spark_env_vars:
              PYSPARK_PYTHON: /databricks/python3/bin/python3
            enable_elastic_disk: true
            data_security_mode: USER_ISOLATION
            runtime_engine: STANDARD
            num_workers: 2
        - job_cluster_key: NB_Bronze_IFS_BatchControl_DataLoad_cluster
          new_cluster:
            cluster_name: ""
            spark_version: 15.4.x-scala2.12
            azure_attributes:
              first_on_demand: 1
              availability: ON_DEMAND_AZURE
              spot_bid_max_price: -1
            node_type_id: Standard_D4ds_v5
            spark_env_vars:
              PYSPARK_PYTHON: /databricks/python3/bin/python3
            enable_elastic_disk: true
            data_security_mode: USER_ISOLATION
            runtime_engine: STANDARD
            num_workers: 2
        - job_cluster_key: TDW_H360_Batch_2_3
          new_cluster:
            cluster_name: ""
            spark_version: 15.4.x-scala2.12
            azure_attributes:
              first_on_demand: 1
              availability: ON_DEMAND_AZURE
              spot_bid_max_price: -1
            node_type_id: Standard_D8ads_v5
            spark_env_vars:
              PYSPARK_PYTHON: /databricks/python3/bin/python3
            enable_elastic_disk: true
            data_security_mode: USER_ISOLATION
            runtime_engine: STANDARD
            autoscale:
              min_workers: 2
              max_workers: 4
      tags:
        Batch: Batch - 2,3
        Environment: Dev
      queue:
        enabled: true
      email_notifications:
            on_failure:
              - ${var.email_notifications}

