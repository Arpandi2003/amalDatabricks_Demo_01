resources:
  jobs:
    WF_Dev_Osaic_Source_Staging:
      name: WF_Dev_Osaic_Source_Staging
      tasks:
        - task_key: NB_Osaic_Dev_Extraction_DataLoad
          notebook_task:
            notebook_path: ../../DataPlatform/Extraction/NB_FlatFile_Osaic_Extraction.py
            # source: WORKSPACE -- having this to ignore the null pointer exception
          min_retry_interval_millis: 900000
          timeout_seconds: 2400
          health:
            rules:
              - metric: RUN_DURATION_SECONDS
                op: GREATER_THAN
                value: 900
          email_notifications:
            on_failure:
              - ${var.email_notifications}
            on_duration_warning_threshold_exceeded:
              - ${var.email_notifications}
          notification_settings:
            no_alert_for_skipped_runs: true
        - task_key: NB_Osaic_Dev_FileMoveMent
          depends_on:
            - task_key: NB_Osaic_Dev_Extraction_DataLoad
          notebook_task:
            notebook_path: ../../DataPlatform/Extraction/NB_FlatFile_Movement.py
            base_parameters:
              SubjectArea: Osaic
            # source: WORKSPACE -- having this to ignore the null pointer exception
          job_cluster_key: DataMovement
          min_retry_interval_millis: 900000
          health:
            rules:
              - metric: RUN_DURATION_SECONDS
                op: GREATER_THAN
                value: 900
          email_notifications:
            on_success:
              - ${var.email_notifications}
            on_failure:
              - ${var.email_notifications}
            on_duration_warning_threshold_exceeded:
              - ${var.email_notifications}
      job_clusters:
        - job_cluster_key: DataMovement
          new_cluster:
            cluster_name: ""
            spark_version: 15.4.x-scala2.12
            azure_attributes:
              first_on_demand: 1
              availability: SPOT_WITH_FALLBACK_AZURE
              spot_bid_max_price: -1
            node_type_id: Standard_D4ds_v5
            spark_env_vars:
              PYSPARK_PYTHON: /databricks/python3/bin/python3
            enable_elastic_disk: true
            data_security_mode: DATA_SECURITY_MODE_STANDARD
            runtime_engine: STANDARD
            kind: CLASSIC_PREVIEW
            is_single_node: false
            autoscale:
              min_workers: 2
              max_workers: 4
        - job_cluster_key: NB_Osaic_Extraction_DataLoad_cluster
          new_cluster:
            cluster_name: ""
            spark_version: 15.4.x-scala2.12
            azure_attributes:
              first_on_demand: 1
              availability: SPOT_WITH_FALLBACK_AZURE
              spot_bid_max_price: -1
            node_type_id: Standard_D4ds_v5
            spark_env_vars:
              PYSPARK_PYTHON: /databricks/python3/bin/python3
            enable_elastic_disk: true
            data_security_mode: DATA_SECURITY_MODE_DEDICATED
            runtime_engine: STANDARD
            kind: CLASSIC_PREVIEW
            is_single_node: false
            autoscale:
              min_workers: 2
              max_workers: 4
      tags:
        Environment: Dev
        Source: Osaic
      queue:
        enabled: true





